
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MonoTools package &#8212; MonoTools 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="using_lightcurve.html" />
    <link rel="prev" title="MonoTools" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="monotools-package">
<h1>MonoTools package<a class="headerlink" href="#monotools-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-MonoTools.fit">
<span id="monotools-fit-module"></span><h2>MonoTools.fit module<a class="headerlink" href="#module-MonoTools.fit" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.fit.</span></span><span class="sig-name descname"><span class="pre">monoModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The core MonoTools model class</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – [description]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.CheckPeriodsHaveGaps">
<span class="sig-name descname"><span class="pre">CheckPeriodsHaveGaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.CheckPeriodsHaveGaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Checking a list of potential periods and seeing if period are observed by counting the number of points in-transit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pers</strong> (<em>list</em>) – List of potential periods (e.g. for each Duotransit alias)</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – Transit duration (days)</p></li>
<li><p><strong>tcen</strong> (<em>float</em>) – Epoch of first transit (days)</p></li>
<li><p><strong>tcen_2</strong> (<em>float</em><em>, </em><em>optional</em>) – Epoch of second transit (days). Defaults to None.</p></li>
<li><p><strong>coverage_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshhold below which we say no transit was observed. Defaults to 0.15.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Boolean array specifying which of the input period list is observed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.CheopsPlanetPropertiesTable">
<span class="sig-name descname"><span class="pre">CheopsPlanetPropertiesTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.CheopsPlanetPropertiesTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Create output compatible with the Cheops “PlanetPropertiesTable”. Not yet implemented</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>planet</strong> (<em>str</em><em>, </em><em>optional</em>) – string name of planet. Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.GP_training">
<span class="sig-name descname"><span class="pre">GP_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">900</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len_lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.GP_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to train GPs on out-of-transit photometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_draws</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of draws from sample. Defaults to 900.</p></li>
<li><p><strong>max_len_lc</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum length of lightcurve to use (limiting to a few 1000 helps with compute time). Defaults to 25000.</p></li>
<li><p><strong>uselc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Specify lightcurve to use. Defaults to None, which takes the <cite>mod.lc</cite> light curve.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.GetSavename">
<span class="sig-name descname"><span class="pre">GetSavename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'load'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.GetSavename" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds unique savename prefixes to class (self.savenames) with two formats:
‘[savefileloc]/[T/K]IC[11-number ID]_[20YY-MM-DD]_[n]…’
‘[savefileloc]/[T/K]IC[11-number ID]_[n]…’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>how</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘load’ or ‘save’. Defaults to ‘load’.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – if how=’save’, whether to overwrite past save or not. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.LoadModelFromFile">
<span class="sig-name descname"><span class="pre">LoadModelFromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loadfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.LoadModelFromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a monoModel object direct from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loadfile</strong> (<em>str</em><em>, </em><em>optional</em>) – File to load from, otherwise it takes the default location using <cite>GetSavename</cite>. Defaults to None.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the load is successful</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.LoadPickle">
<span class="sig-name descname"><span class="pre">LoadPickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loadname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.LoadPickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from saved pickle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loadname</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename to load from. Defaults to None, which loads from <cite>savenames</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.MakeCheopsOR">
<span class="sig-name descname"><span class="pre">MakeCheopsOR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DR2ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_eff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oot_min_orbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timing_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Texp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_orbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pretrans_orbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_intrans_orbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbits_flex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observe_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.018</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ORs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prio_1_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prio_3_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_orbits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfilesuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_output_ORs.csv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.MakeCheopsOR" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Given a list of observable transits (which are outputted from <cite>trace_to_cheops_transits</cite>),</dt><dd><p>create a csv which can be run by pycheops make_xml_files to produce input observing requests (both to FC and observing tool).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DR2ID</strong> (<em>int</em>) – Gaia DR2 ID</p></li>
<li><p><strong>pl</strong> (<em>str</em><em>, </em><em>optional</em>) – name of planet in self.planets dict to process. Defaults to None, i.e. assumes all planets)</p></li>
<li><p><strong>min_eff</strong> (<em>int</em><em>, </em><em>optional</em>) – minimum efficiency in percent. Defaults to 45</p></li>
<li><p><strong>oot_min_orbits</strong> (<em>int</em><em>, </em><em>optional</em>) – minimum number of out-of-transit orbits to include both before &amp; after (this may be higher if timing uncertainty is worse). Defaults to 2.</p></li>
<li><p><strong>timing_sigma</strong> (<em>float</em><em>,</em><em>optional</em>) – Number of uncertainty</p></li>
<li><p><strong>t_start</strong> (<em>float</em><em>, </em><em>optional</em>) – time of start of Cheops observations, in same jd as model (e.g. TESS HJD BJD-2457000). Defaults to None.</p></li>
<li><p><strong>t_end</strong> (<em>float</em><em>, </em><em>optional</em>) – time of end of Cheops observations, in same jd as model (e.g. TESS HJD BJD-2457000). Defaults to None.</p></li>
<li><p><strong>Texp</strong> (<em>float</em><em>, </em><em>optional</em>) – Exposure Time of CHEOPS observations. Defaults to None, i.e. generated by PyCheops</p></li>
<li><p><strong>max_orbits</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum number of orbits per visit. Defaults to 14 (i.e. 1d)</p></li>
<li><p><strong>min_pretrans_orbits</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of orbits to insist happen before (and after) transit, rather than either before/after (as with oot_min_orbits). Defaults to 0.5</p></li>
<li><p><strong>min_intrans_orbits</strong> (<em>float</em><em>, </em><em>optional</em>) – In the case that the visit duration does not cover the full transit, this tells us how much of the transit we have to observe</p></li>
<li><p><strong>orbits_flex</strong> (<em>float</em><em>, </em><em>optional</em>) – Flexibility in orbits. Defaults to None</p></li>
<li><p><strong>observe_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – threshold above which to create ORs Default=0.018. Defaults to 0.018.</p></li>
<li><p><strong>prio_1_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Rough percentage of ORs we want to make P1 on Cheops. Defaults to 0.25.</p></li>
<li><p><strong>prio_3_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Rough percentage of ORs we want to make P3 on Cheops. Defaults to 0.0 - i.e. no P3 observations</p></li>
<li><p><strong>min_orbits</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum number of total orbits to observe. Defaults to 4.0.</p></li>
<li><p><strong>outfilesuffix</strong> (<em>str</em><em>, </em><em>optional</em>) – suffix place to save CSV. Defaults to ‘_output_ORs.csv’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>panda DF to save as csv in location where one can run make_xml_files. e.g. <cite>make_xml_files output.csv –auto-expose -f</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>df = model.PredictFutureTransits</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.MakeTable">
<span class="sig-name descname"><span class="pre">MakeTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['all']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.MakeTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Make table from MCMC Samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>short</strong> (<em>bool</em><em>, </em><em>optional</em>) – Create “short” table (i.e. without hyperparameters). Defaults to True.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save to csv? Defaults to True.</p></li>
<li><p><strong>cols</strong> (<em>list</em><em>, </em><em>optional</em>) – [‘all’] or list of selected column names. Defaults to [‘all’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of parameters and specific parameters for the samples</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.Plot">
<span class="sig-name descname"><span class="pre">Plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newgp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_gp_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plottype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Varied photometric plotting function for MonoTransit model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interactive</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot interactive bokeh image? Defaults to False i.e. matplotlib plot</p></li>
<li><p><strong>n_samp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use to initialise the RV plotting. Defaults to 300.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>interp</strong> (<em>bool</em><em>, </em><em>optional</em><em>)</em><em> Whether to interpolate the GP fits to create GP timeseries for all t</em><em> (</em><em>bin_oot must be True</em>) – </p></li>
<li><p><strong>newgp</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>return_fig</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>max_gp_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum length of photometric data to . Defaults to 20000.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>bin_gp</strong> (<em>bool</em><em>, </em><em>optional</em>) – Bin GP or use raw x points? Defaults to True.</p></li>
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – File location to plot. Defaults to None, which uses <cite>mod.savenames</cite></p></li>
<li><p><strong>palette</strong> (<em>[</em><em>str</em><em>, </em><em>optional</em>) – Colour palette to plot with. Defaults to None.</p></li>
<li><p><strong>plot_flat</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot flatted lightcurve instead of “raw”. Defaults to True.</p></li>
<li><p><strong>pointcol</strong> (<em>str</em><em>, </em><em>optional</em>) – Point colour of smallest points. Defaults to “k”.</p></li>
<li><p><strong>plottype</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of image to save. Defaults to ‘png’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.PlotCorner">
<span class="sig-name descname"><span class="pre">PlotCorner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corner_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_marg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.PlotCorner" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Corner plot for MCMC samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corner_vars</strong> (<em>list</em><em>, </em><em>optional</em>) – List of parameter names to include. Defaults to None, which uses stellar density &amp; various important orbital params.</p></li>
<li><p><strong>use_marg</strong> (<em>bool</em><em>, </em><em>optional</em>) – Use marginalised parameters (e.g. weighted average across all aliases) or individual alias values. Defaults to True.</p></li>
<li><p><strong>truths</strong> (<em>list</em><em>, </em><em>optional</em>) – “True” parameters for the selected parameters (e.g. for use in testing/comparisons). Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.PlotPeriods">
<span class="sig-name descname"><span class="pre">PlotPeriods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.PlotPeriods" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Marginalised probabilities of the possible periods</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – File location. Defaults to None, which takes location from <cite>savenames</cite></p></li>
<li><p><strong>ylog</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set y axis as log scale? Defaults to True.</p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of total bins . Defaults to 25.</p></li>
<li><p><strong>pmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Max period on plot. Defaults to None.</p></li>
<li><p><strong>pmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Min period on plot. Defaults to None.</p></li>
<li><p><strong>ymin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum on y axis (logprob). Defaults to None.</p></li>
<li><p><strong>ymax</strong> (<em>float</em><em>, </em><em>optional</em>) – Max on y axis (logprob). Defaults to None.</p></li>
<li><p><strong>xlog</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set x axis (period) to log scale? Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.PlotRVs">
<span class="sig-name descname"><span class="pre">PlotRVs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_resids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plottype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmargtoplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.PlotRVs" title="Permalink to this definition">¶</a></dt>
<dd><p>Varied plotting function for RVs of MonoTransit model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interactive</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot interactive bokeh image? Defaults to False i.e. matplotlib plot</p></li>
<li><p><strong>plot_alias</strong> (<em>str</em><em>, </em><em>optional</em>) – How to plot RV aliaes - ‘all’ or ‘best’. Defaults to ‘best’.</p></li>
<li><p><strong>nbest</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of the best aliases to plot. Defaults to 4.</p></li>
<li><p><strong>n_samp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use to initialise the RV plotting. Defaults to 300.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>return_fig</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>plot_resids</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>plot_loc</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>palette</strong> (<em>str</em><em>, </em><em>optional</em>) – colour palette to use. Defaults to None.</p></li>
<li><p><strong>pointcol</strong> (<em>str</em><em>, </em><em>optional</em>) – small point colour to use. Defaults to ‘k’.</p></li>
<li><p><strong>plottype</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of image to save, if not interactive. Defaults to ‘png’.</p></li>
<li><p><strong>raster</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to rasterize the image to reduce file size. Defaults to False.</p></li>
<li><p><strong>nmargtoplot</strong> (<em>int</em><em>, </em><em>optional</em>) – Which marginalised planet (Mono/Duo) to plot. Defaults to 0, i.e. first planet</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – [description]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.PlotTable">
<span class="sig-name descname"><span class="pre">PlotTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.PlotTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot table as PDF (i.e. to assemble PDF report)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – File location. Defaults to None, which uses <cite>mod.savenames</cite></p></li>
<li><p><strong>return_table</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return DF figure? Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of parameters and specific parameters (output from <cite>MakeTable</cite>)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.PredictFutureTransits">
<span class="sig-name descname"><span class="pre">PredictFutureTransits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_multis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.PredictFutureTransits" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataframe of potential transits of all Duo candidates between time_start &amp; time_end dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_start</strong> (<em>Astropy.Time object</em><em> or </em><em>float</em>) – Astropy.Time date or julian date (in same base as lc) for the start of the observing period</p></li>
<li><p><strong>time_end</strong> (<em>Astropy.Time object</em><em> or </em><em>float</em>) – Astropy.Time date or julian date (in same base as lc) for the end of the observing period</p></li>
<li><p><strong>include_multis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Also generate transits for multi-transiting planets? Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of transits observable between time_start and time_end.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p># e.g. after running model.RunMcmc():
df = model.PredictFutureTransits(Time(‘2021-06-01T00:00:00.000’,format=’isot’),Time(‘2021-10-01T00:00:00.000’,format=’isot’))</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.RunMcmc">
<span class="sig-name descname"><span class="pre">RunMcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuesampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.RunMcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Run PyMC3 sampler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_draws</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of independent samples to draw from each chain. Defaults to 500.</p></li>
<li><p><strong>n_burn_in</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps to ‘burn in’ the sampler. Defaults to None in which case it becomes 2/3 the number of draws</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Overwrite past stored data in this model? Defaults to False.</p></li>
<li><p><strong>continuesampling</strong> (<em>bool</em><em>, </em><em>optional</em>) – Continue sampling from a previous sampler? Defaults to False.</p></li>
<li><p><strong>chains</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of chains to run. Defaults to 4.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.SaveModelToFile">
<span class="sig-name descname"><span class="pre">SaveModelToFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.SaveModelToFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a monoModel object direct to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savefile</strong> (<em>str</em><em>, </em><em>optional</em>) – File location to save to, otherwise it takes the default location using <cite>GetSavename</cite>. Defaults to None.</p></li>
<li><p><strong>limit_size</strong> (<em>bool</em><em>, </em><em>optional</em>) – If we want to limit size this function can delete unuseful hyperparameters before saving. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.ToLatexTable">
<span class="sig-name descname"><span class="pre">ToLatexTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'columns'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.ToLatexTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Creating a Latex table for specfic parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>varnames</strong> (<em>str</em><em>, </em><em>optional</em>) – . Defaults to ‘all’.</p></li>
<li><p><strong>order</strong> (<em>str</em><em>, </em><em>optional</em>) – Whether to stack by ‘columns’ or ‘rows’. Defaults to ‘columns’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Multi-line latex table string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_duo">
<span class="sig-name descname"><span class="pre">add_duo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_duo" title="Permalink to this definition">¶</a></dt>
<dd><p>add_duo Adds a transiting planet with two non-consecutive transits to planet properties dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pl_dic</strong> (<em>dict</em>) – Dictionary of planet properties which requires:
tcen: transit epoch in same units as time array (i.e. TJD)
tcen_2: second transit epoch in same units as time array (i.e. TJD)
period: (optional) transit period in same units as time array (i.e. days)
period_err: (optional) transit period error in same units as time array (i.e. days)
K: RV semi-amplitude in m/s</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Planet name (i.e. ‘01’, ‘b’, or ‘Malcolm’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_mono">
<span class="sig-name descname"><span class="pre">add_mono</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_mono" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a transiting planet with a single transit to planet properties dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pl_dic</strong> (<em>dict</em>) – Dictionary of planet properties which requires:
tcen: transit epoch in same units as time array (i.e. TJD)
tcen_err: transit epoch error (optional)
period: transit period in same units as time array (i.e. days)
period_err: transit period error in same units as time array (i.e. days)
K: RV semi-amplitude in m/s</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Planet name (i.e. ‘01’, ‘b’, or ‘Malcolm’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_multi">
<span class="sig-name descname"><span class="pre">add_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a transiting planet with multiple, consecutive transits to planet properties dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pl_dic</strong> (<em>dict</em>) – Dictionary of planet properties which requires:
tcen: transit epoch in same units as time array (i.e. TJD)
tcen_err: transit epoch error (optional)
period: transit period in same units as time array (i.e. days)
period_err: transit period error in same units as time array (i.e. days)
K: RV semi-amplitude in m/s</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Planet name (i.e. ‘01’, ‘b’, or ‘Malcolm’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_planet">
<span class="sig-name descname"><span class="pre">add_planet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pltype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_planet" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds any planet type to planet properties dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pltype</strong> (<em>str</em>) – Type of planet - i.e. ‘mono’, ‘duo’, ‘multi’ or ‘rvplanet’</p></li>
<li><p><strong>pl_dic</strong> (<em>dict</em>) – Dictionary of planet properties which requires:
depth: transit depth in unitless flux ratio (NOT ppm or ppt)
tdur: transit duration in same units as time array (i.e. days)
tcen: transit epoch in same units as time array (i.e. TJD)
period: (if multi or rvplanet) transit period in same units as time array (i.e. days)
period_err: (if rvplanet) transit period error in same units as time array (i.e. days)
tcen_2: (if duo) second transit epoch in same units as time array (i.e. TJD)</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Planet name (i.e. ‘01’, ‘b’, or ‘Malcolm’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_rvplanet">
<span class="sig-name descname"><span class="pre">add_rvplanet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_rvplanet" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds non-transiting planet seen only in RVs to planet properties dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pl_dic</strong> (<em>dict</em>) – Dictionary of planet properties which requires:
tcen: transit epoch in same units as time array (i.e. TJD)
tcen_err: transit epoch error (optional)
period: transit period in same units as time array (i.e. days)
period_err: transit period error in same units as time array (i.e. days)
K: RV semi-amplitude in m/s</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Planet name (i.e. ‘01’, ‘b’, or ‘Malcolm’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.add_rvs">
<span class="sig-name descname"><span class="pre">add_rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_poly_trend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.add_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dictionary of rvs with arrays of:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rv_dic</strong> (<em>dict</em>) – <p>Dictionary of radial velocity info.
Necessary values: “time”, “rv”, “rv_err”
Optional values: “rv_unit” (assumes m/s),</p>
<blockquote>
<div><p>”tele_index” (unique telescope id for each RV),
“jd_base” (assumes same as lc),
“jitter_min” (default=0.5)
“logjitter_mean” (default=0.0)
“logjitter_sd” (default=0.4, or ~40%)</p>
</div></blockquote>
</p></li>
<li><p><strong>n_poly_trend</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 2.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.calc_gap_edge_likelihoods">
<span class="sig-name descname"><span class="pre">calc_gap_edge_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mono</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.calc_gap_edge_likelihoods" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Calculate the effect on likelihood of a transit model for those transits which occur at the “edges” of photometric data coverage.</dt><dd><dl class="simple">
<dt>e.g. In the case that we are not creating transit models for each period gap, we want to calculate how the</dt><dd><p>“edges” of those gaps affect the log probability.Effectively we’ll calculate the likelihood of the edges
of the gaps w.r.t the initial-fit transit model. This will then become a 1D (e.g. linear) polynomial
which sets the logprior at the edges of each monotransit gap.</p>
</dd>
</dl>
<p>The saved monotransit dictionary is updated within the model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mono</strong> (<em>str</em>) – Name of the selected Monotransit in the <cite>mod.planets</cite></p></li>
<li><p><strong>n_check</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of positions to check across each edge. Defaults to 100.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.compute_duo_period_aliases">
<span class="sig-name descname"><span class="pre">compute_duo_period_aliases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.compute_duo_period_aliases" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculating Duotransit period aliases</dt><dd><dl class="simple">
<dt>Given the time array, the t0 of transit, and the fact that two transits are observed,</dt><dd><p>we want to calculate a distribution of periods, and then remove those which are impossible/observed</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duo</strong> (<em>dict</em>) – Planet properties dictionary for the selected Duotransit, as described in <cite>add_duo</cite></p></li>
<li><p><strong>dur</strong> (<em>float</em><em>, </em><em>optional</em>) – Transit duration [days]. Defaults to 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated planet properties dictionary with <cite>period_aliases</cite> term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.compute_period_gaps">
<span class="sig-name descname"><span class="pre">compute_period_gaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.compute_period_gaps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute regions of period space which are not covered by photometry (i.e. find the gaps)</dt><dd><p>e.g. Given the time array, the t0 of transit, and the fact that another transit is not observed,
we want to calculate a distribution of impossible periods to remove from the Period PDF post-MCMC
In this case, a list of periods is returned, with all points within 0.5dur to be cut</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcen</strong> (<em>float</em>) – transit epoch</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – transit duration (in days)</p></li>
<li><p><strong>depth</strong> (<em>float</em>) – transit depth (in ratio, i.e. NOT ppt/ppm)</p></li>
<li><p><strong>max_per</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum period bound. Defaults to 8000.</p></li>
<li><p><strong>SNR_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Period gap start and ends, with each gap start/end forming a tuple entry to the array
rmsseries (array): Array of binned times and RMS scatter for each time at the implied duration, as calculated by <cite>compute_rms_series</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gap_start_ends (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.compute_rms_series">
<span class="sig-name descname"><span class="pre">compute_rms_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps_per_dur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.compute_rms_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing an RMS time series for the lightcurve by binning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdur</strong> (<em>float</em>) – transit duration</p></li>
<li><p><strong>split_gap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Duration at which to cut the lightcurve and compute in loops. Defaults to 2.0.</p></li>
<li><p><strong>n_steps_per_dur</strong> (<em>int</em><em>, </em><em>optional</em>) – number of steps with which to cut up each duration. Odd numbers work most uniformly. Defaults to 7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2-column array of bin times, and bin RMS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.drop_planet">
<span class="sig-name descname"><span class="pre">drop_planet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.drop_planet" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes planet from saved planet properties dict (mod.planets)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – Name of planet within planets dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.getLDs">
<span class="sig-name descname"><span class="pre">getLDs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tess'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.getLDs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Gets theoretical quadratic Limb Darkening parameters for any specified mission.</dt><dd><p>This is done by first interpolating the theoretical samples (e.g. Claret) onto Teff and logg axes. FeH is typically fixed to the closest value.
Then, using stellar samples from normally-distributed Teff and logg, a distribution of values for each LD parameter are retrieved.
This can be performed for TESS, Kepler, CoRoT and CHEOPS bandpasses.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate</p></li>
<li><p><strong>mission</strong> (<em>str</em><em>, </em><em>optional</em>) – [description]. Defaults to ‘tess’.</p></li>
<li><p><strong>how</strong> (<em>str</em><em>, </em><em>optional</em>) – [description]. Defaults to ‘2’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Two-column array of quadratic limb darkening parameters (u1 and u2) as generated from the interpolated Normally-distributed Teff &amp; logg</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_gp_to_plot">
<span class="sig-name descname"><span class="pre">init_gp_to_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_gp_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newgp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_gp_to_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the GP model for plotting.</p>
<blockquote>
<div><p>As it is memory-intensive to store predicted GP samples for each datapoint in the light curve during sampling,
this is not done by default by MonoTools. Instead, the GPs are re-computed after-the-fact from the sampled
hyperparameters, enabling plotting.
This re-computation is typically done on limited shorter segments of lightcurve.</p>
<p>The result is the <cite>gp_to_plot</cite> array, which is a dictionary of predicted GP flux percentiles computed for each point in the time series.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to produce. Defaults to 7.</p></li>
<li><p><strong>max_gp_len</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum length of photometry to compute a GP on. Defaults to 12000.</p></li>
<li><p><strong>interp</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to interpolate the binned out-of-transit GP to the fine time grid (only possible with self.bin_oot is used)</p></li>
<li><p><strong>newgp</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to initialise a new GP using the sampled kernel hyperparameters to re-predict the fine time grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_interpolated_Mp_prior">
<span class="sig-name descname"><span class="pre">init_interpolated_Mp_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_interpolated_Mp_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a 2D interpolated prior for the mass of a planet given the radius</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_interpolated_v_prior">
<span class="sig-name descname"><span class="pre">init_interpolated_v_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_interpolated_v_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the interpolated functions for log prob vs log velocity and marginalised eccentricity vs log velocity</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_lc">
<span class="sig-name descname"><span class="pre">init_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise light curve. This can be done either after or before model initialisation.
This function creates transit maskes and flattens/bins the light curve in ways to avoid influencing the transit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_model">
<span class="sig-name descname"><span class="pre">init_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initalise fitting model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to overwrite. Defaults to False.</p>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>assume_circ (int, optional): Assume circular orbits (no ecc &amp; omega)? Defaults to False
use_GP (bool, optional): Use GPs to co-fit light curve? Defaults to True
train_GP (bool, optional): Train the lightcurve GP on out-of-transit data before sampling? Defaults to True
constrain_LD (bool, optional): Use constrained LDs from model or unconstrained? Defaults to True
ld_mult (float, optional): How much to multiply theoretical LD param uncertainties. Defaults to 3.
useL2 (bool, optional): Fit for “second light” (i.e. a binary or planet+blend). Defaults to False
FeH (float, optional): Stellar FeH. Defaults to 0.0
LoadFromFile (bool, optional): Load previous model? Defaults to False
cutDistance (float, optional): cut out points further than cutDistance*Tdur. 0.0 means no cutting. Defaults to 3.75
maskdist (float, optional): Distance, in transit durations, from set transits, to “mask” as in-transit data when e.g. flattening.</p>
<blockquote>
<div><p>Defaults to 0.666</p>
</div></blockquote>
<dl class="simple">
<dt>force_match_input (float OR None, optional): Float/None add potential with this the sigma between the input and the output logror and logdur</dt><dd><p>to force MCMC to match the input duration &amp; maximise logror [e.g. 0.1 = match to 1-sigma=10%]. Defaults to None</p>
</dd>
</dl>
<p>debug (int, optional): print debug statements? Defaults to False
fit_params (list, optional): fit these parameters. Options: [‘logror’, ‘b’ or ‘tdur’, ‘ecc’, ‘omega’].</p>
<blockquote>
<div><p>Defaults to [‘logror’,’b’,’tdur’, ‘t0’]</p>
</div></blockquote>
<dl class="simple">
<dt>marginal_params (list, optional): marginalise over these parameters. Options: [‘per’, ‘b’ ´or ‘tdur’, ‘ecc’, ‘omega’,’logror’].</dt><dd><p>Defaults to [‘per’,’ecc’,’omega’]</p>
</dd>
</dl>
<p>interpolate_v_prior (bool, optional): Whether to use interpolation to produce transit velocity prior. Defaults to True
ecc_prior (str, optional): ‘uniform’, ‘kipping’ or ‘vaneylen’. If ‘auto’ we decide based on multiplicity. Defaults to ‘auto’
per_index (float, optional): period prior index e.g. P^{index}. -8/3 in to Kipping 2018. Defaults to -8/3
derive_K (bool, optional): If we have RVs, do we derive K for each alias or fit for a single K param. Defaults to True
use_multinest (bool, optional): Use Multinest sampling [NOT SUPPORTED YET]. Defaults to False
use_pymc3 (bool, optional): Use PyMC3 sampling? Defaults to True
bin_oot (bool, optional): bool - Bin points outside the cutDistance to 30mins. Defaults to True</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_plot">
<span class="sig-name descname"><span class="pre">init_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plottype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialising plotting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interactive</strong> (<em>bool</em><em>, </em><em>optional</em>) – Interactive bokeh plot? Defaults to False.</p></li>
<li><p><strong>gap_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Threshold in days above which we cut the plot into smaller figures. Defaults to 10.</p></li>
<li><p><strong>plottype</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘lc’ or ‘rv’. Defaults to ‘lc’.</p></li>
<li><p><strong>pointcol</strong> (<em>str</em><em>, </em><em>optional</em>) – colour of smallest raw points. Defaults to ‘k’ (black)</p></li>
<li><p><strong>palette</strong> (<em>str</em><em>, </em><em>optional</em>) – specify the (i.e. seaborn) colour palette to use. Defaults to None.</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of colours to use. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_pymc3">
<span class="sig-name descname"><span class="pre">init_pymc3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ld_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_pymc3" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the PyMC3 sampler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_rvs_to_plot">
<span class="sig-name descname"><span class="pre">init_rvs_to_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_rvs_to_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise RV models to plot.</p>
<p>The result is the <cite>rvs_to_plot</cite> array.
This is formed of two hierarchical dictionaries - one for each RV x point (<cite>rvs_to_plot[“x”]</cite>), and one for a fine grid of time points (<cite>rvs_to_plot[“t”]</cite>)
Then, each contains the following dictionaries of percentiles (keys=[‘-2sig’,’-1sig’,’med’,’+1sig’,’+2sig’]) computed for each x and t point in the time series:</p>
<blockquote>
<div><ul class="simple">
<li><p>the RV polynomial trend (e.g. <cite>rvs_to_plot[“x”][“trend”]</cite>)</p></li>
<li><p>a summed RV model (e.g. <cite>rvs_to_plot[“x”][“all”]</cite>)</p></li>
<li><p>combined RV models with the trend (e.g. <cite>rvs_to_plot[“x”][“all+trend”]</cite>)</p></li>
<li><dl class="simple">
<dt>For each individual planet dictionaries with either:</dt><dd><ul>
<li><p>marginalised RV model given the multiple perid aliases (for Duo/Monotransiting planets, e.g. <cite>rvs_to_plot[“x”][“marg”]</cite>)</p></li>
<li><p>Individual RV models (for rv planets/multi-transiting planets, e.g. <cite>rvs_to_plot[“x”][0]</cite>)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of MCMC samples to use to generate RV models. Defaults to 300</p></li>
<li><p><strong>plot_alias</strong> (<em>str</em><em>, </em><em>optional</em>) – How to plot aliases - either ‘all’ or ‘best’. Defaults to ‘all’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_starpars">
<span class="sig-name descname"><span class="pre">init_starpars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.,</span> <span class="pre">0.08,</span> <span class="pre">0.08])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([5227,</span> <span class="pre">100,</span> <span class="pre">100])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([4.3,</span> <span class="pre">1.,</span> <span class="pre">1.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FeH</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhostar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_starpars" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds stellar parameters to model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Rstar</strong> (<em>list</em><em>, </em><em>optional</em>) – Stellar radius in Rsol in format [value, neg_err, pos_err]. Defaults to np.array([1.0,0.08,0.08]).</p></li>
<li><p><strong>Teff</strong> (<em>list</em><em>, </em><em>optional</em>) – Stellar effective Temperature in K in format [value, neg_err, pos_err]. Defaults to np.array([5227,100,100]).</p></li>
<li><p><strong>logg</strong> (<em>list</em><em>, </em><em>optional</em>) – Stellar logg in cgs in format [value, neg_err, pos_err]. Defaults to np.array([4.3,1.0,1.0]).</p></li>
<li><p><strong>FeH</strong> (<em>float</em><em>, </em><em>optional</em>) – Stellar log Metallicity. Defaults to 0.0.</p></li>
<li><p><strong>rhostar</strong> (<em>list</em><em>, </em><em>optional</em>) – Stellar density in rho_sol (1.411gcm^-3) in format [value, neg_err, pos_err]. Defaults to None.</p></li>
<li><p><strong>Mstar</strong> (<em>float</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Stellar mass in Msol either as a float or in format [value, neg_err, pos_err]. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.init_trans_to_plot">
<span class="sig-name descname"><span class="pre">init_trans_to_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.init_trans_to_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialising the transit models to plot</p>
<p>The result is the <cite>trans_to_plot</cite> array, which is a dictionary of predicted transit flux model percentiles computed for each point in the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_samp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use from the MCMC trace to generate the models &amp; percentiles. Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.fit.monoModel.vals_to_latex">
<span class="sig-name descname"><span class="pre">vals_to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.fit.monoModel.vals_to_latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to turn percentiles (i.e. -1, 0, and +1 sigma values) into rounded latex strings for a table.
This function identifies when errorbars are unequal (i.e. val ^ +sig1 _ -sig2), and when they are equal (val +/- sig)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vals</strong> (<em>list</em>) – Values in the form [-1-sigma, median, +1-sigma]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Latex string for a single parameter’s value and errors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="MonoTools.fit.theano_pars">
<span class="sig-prename descclassname"><span class="pre">MonoTools.fit.</span></span><span class="sig-name descname"><span class="pre">theano_pars</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'base_compiledir':</span> <span class="pre">'/Volumes/LUVOIR/MonoToolsData/.theano_dir_4',</span> <span class="pre">'device':</span> <span class="pre">'cpu',</span> <span class="pre">'floatX':</span> <span class="pre">'float64',</span> <span class="pre">'gcc.cxxflags':</span> <span class="pre">'-fbracket-depth=1024'}</span></em><a class="headerlink" href="#MonoTools.fit.theano_pars" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’/usr/local/Cellar/gcc/9.3.0_1/bin/g++-9’</p>
</dd>
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’cxx=/Library/Developer/CommandLineTools/usr/bin/g++’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-MonoTools.lightcurve">
<span id="monotools-lightcurve-module"></span><h2>MonoTools.lightcurve module<a class="headerlink" href="#module-MonoTools.lightcurve" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.lightcurve.</span></span><span class="sig-name descname"><span class="pre">lc</span></span><a class="headerlink" href="#MonoTools.lightcurve.lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base lightcurve class which allows for standard binning, flattening, loading, etc.
Typically for objects observed by multiple sectors, campaigns, missions, etc. the <cite>multilc</cite> daughter class should be used instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.OOTbin">
<span class="sig-name descname"><span class="pre">OOTbin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">near_transit_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.020833333333333332</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.OOTbin" title="Permalink to this definition">¶</a></dt>
<dd><p>Out-Of-Transit binning of the lightcurve (to speed up computation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>near_transit_mask</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>use_flat</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – [description]. Defaults to 1/48.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.bin">
<span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['flux']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.020833333333333332</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_masked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extramask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Binning lightcurve to e.g. 30-min cadence for planet search</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeseries</strong> (<em>list</em><em>, </em><em>optional</em>) – List of timeseries which to bin. Defaults to [‘flux’]</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of bins in units matching lightcurve time. Defaults to 1/48.</p></li>
<li><p><strong>split_gap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size to count as a “gap” in the lightcurve. Defaults to 0.8.</p></li>
<li><p><strong>use_masked</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to bin using only the masked flux array. Defaults to True.</p></li>
<li><p><strong>extramask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Added mask to use when binning, otherwise either only <cite>mask</cite> or nothing is used. Defaults to None.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite already-stored binned data array. Defaults to False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.change_flx_system">
<span class="sig-name descname"><span class="pre">change_flx_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_flx_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.change_flx_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert lightcurves between flux unit/systems, e.g. to a lightcurve in ppm normalised to 0 (‘ppm’), or to a flux ratio normalised to 1 (‘norm1’)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_flx_system</strong> (<em>str</em>) – One of “ppm”, “ppt”, “norm0”, “norm1” or “elec”. These denote:
- <cite>ppm</cite>: normalised lightcurve with median at 0.0 with units in parts per million
- <cite>ppt</cite>: normalised lightcurve with median at 0.0 with units in parts per thousand
- <cite>norm0</cite>: normalised lightcurve with median at 0.0 with units as a ratio (0-&gt;1)
- <cite>norm1</cite>: normalised lightcurve with median at 1.0 with units as a ratio (0-&gt;1)
- <cite>elec</cite>: un-normalised lightcurve with units of pure electrons and median proportional to stellar magnitude</p></li>
<li><p><strong>mask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Boolean array masking bad points to create median. Default is None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.change_jd_base">
<span class="sig-name descname"><span class="pre">change_jd_base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_jd_base</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.change_jd_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Change timing epoch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_jd_base</strong> (<em>float</em>) – New base for timing array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.flatten">
<span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['flux']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knot_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaclip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flattype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bspline'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polydegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>AI is creating summary for flatten</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeseries</strong> (<em>list</em><em>, </em><em>optional</em>) – List of timeseries to flatten. Defaults to [‘flux’].</p></li>
<li><p><strong>knot_dist</strong> (<em>float</em><em>, </em><em>optional</em>) – Typical distance between spline “knots” OR polynomial fitting lengths. Defaults to 1.25.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum iterations to perform to find/remove anomalies. Defaults to 10.</p></li>
<li><p><strong>sigmaclip</strong> (<em>float</em><em>, </em><em>optional</em>) – Significance of anomalies from the mean above which we clip. Defaults to 3..</p></li>
<li><p><strong>flattype</strong> (<em>str</em><em>, </em><em>optional</em>) – Either use a ‘bspline’ (which fits smooth splines while iterating away anomalies/transits/etc)
Or a ‘polystep’ (which uses out-of-box polynomials to smooth data without influencing transit depth). Defaults to ‘bspline’.</p></li>
<li><p><strong>stepsize</strong> (<em>float</em><em>, </em><em>optional</em>) – [description]. Defaults to 0.15.</p></li>
<li><p><strong>reflect</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to True.</p></li>
<li><p><strong>polydegree</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 3.</p></li>
<li><p><strong>transit_mask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Mask of transits where 0 = in transit and 1 = out of transit. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.load_lc">
<span class="sig-name descname"><span class="pre">load_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_errs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_flx_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ppt'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.load_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading lightcuve given vital infomation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>np.ndarray</em>) – time array</p></li>
<li><p><strong>fluxes</strong> (<em>np.array</em><em> or </em><em>dict</em>) – Either a numpy array of flux, or a Dictionary of various flux arrays</p></li>
<li><p><strong>flux_errs</strong> (<em>np.array</em><em> or </em><em>dict</em>) – Either a numpy array of flux errors or a Dictionary of various flux error arrays. This should only have fluxes as seen in the fluxes dict with “_err” as suffixes</p></li>
<li><p><strong>src</strong> (<em>str</em>) – String describing source of lightcurve (e.g. pipeline)</p></li>
<li><p><strong>mission</strong> (<em>str</em>) – Photometric mission/telescope of lightcurve (e.g. k2, tess, kepler, etc)</p></li>
<li><p><strong>jd_base</strong> (<em>float</em>) – JD epoch for time=0</p></li>
<li><p><strong>flx_system</strong> (<em>str</em>) – Type of flux - either “ppm”, “ppt”, “norm0”, “norm1” or “elec” (see <cite>change_flx_system</cite>)</p></li>
<li><p><strong>cadence</strong> (<em>float OR int OR np.ndarray</em>) – <dl class="simple">
<dt>Either - cadence in seconds OR</dt><dd><ul>
<li><p>a 1D array of strings in format [telescope ID k1/k2/co/te/ch]_[cadence in secs]_[pipeline source]_[Sector/Q/camp]</p></li>
</ul>
</dd>
</dl>
<p>If left None this is estimated from time array. Default is None</p>
</p></li>
<li><p><strong>default_flx_system</strong> (<em>str</em>) – Type of flux - either “ppm”, “ppt”, “norm0”, “norm1” or “elec” (see <a href="#id1"><span class="problematic" id="id2">`</span></a>change_flx_system <a href="#id3"><span class="problematic" id="id4">`</span></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.make_fluxmask">
<span class="sig-name descname"><span class="pre">make_fluxmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_arr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_all_anom_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_of_orbit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_islands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_transit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extreme_anom_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.make_fluxmask" title="Permalink to this definition">¶</a></dt>
<dd><p>mask bad points in lightcurve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cut_all_anom_lim</strong> (<em>float</em><em>, </em><em>optional</em>) – Cut all single points above AND below lightcurve further away than this anomalous value. Defaults to 5.0.</p></li>
<li><p><strong>end_of_orbit</strong> (<em>bool</em><em>, </em><em>optional</em>) – Check if masking lightcurve segments before/after a gap vastly reduces rms? Defaults to True.</p></li>
<li><p><strong>use_flat</strong> (<em>bool</em><em>, </em><em>optional</em>) – Run mask on flattened flux array? Defaults to False.</p></li>
<li><p><strong>mask_islands</strong> (<em>bool</em><em>, </em><em>optional</em>) – Mask small islands of data in time series?  Defaults to False.</p></li>
<li><p><strong>input_mask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – A previously-defined mask. Defaults to None.</p></li>
<li><p><strong>in_transit</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – A mask where all in-transit points are flagged as True. Defaults to None</p></li>
<li><p><strong>cut_periodic_high_regions</strong> (<em>bool</em><em>, </em><em>optional</em>) – Using the orbital period, should we cut the periodic high SAA regions? Defaults to False</p></li>
<li><p><strong>extreme_anom_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Flux variation in ratio above/below which, we will out. Defaults to 0.25 (i.e. points above/below 25% are missing)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Making mask for timeseries. Requires both a “flux” mask (i.e. bad/anomalous points) and a “cadence” mask (i.e. duplicate cadences due to multiple lightcurve sources)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['flux']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jump_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the lightcurve using Matplotlib.</p>
<p>In the default case, either data that is extremely long (i.e Kepler), or data that has a large gap (i.e. TESS Y1/3) will be split into two rows.
Gaps between quarters, sectors, etc will result in horizontally-split plot frames.
Typically ~30min cadence data is plotted unbinned and shorter-cadence ddata is plotted raw and with 30-minute bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of rows for the plot to have. Defaults to None, in which case this is automatically guessed between 1 and 4</p></li>
<li><p><strong>timeseries</strong> (<em>list</em><em>, </em><em>optional</em>) – List of which timeseries to plot (i.e. enables plotting of e.g. background flux or flattened flux. Defaults to [‘flux’]</p></li>
<li><p><strong>jump_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Threshold beyond which we call a gap/jump between observations a major difference. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.remove_binned_arrs">
<span class="sig-name descname"><span class="pre">remove_binned_arrs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.remove_binned_arrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Removing binned timeseries arrays. This is necessary to stack lightcurves</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.remove_flattened_arrs">
<span class="sig-name descname"><span class="pre">remove_flattened_arrs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.remove_flattened_arrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Removing flattened timeseries arrays. This reduces size when saving</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.lc.sort_timeseries">
<span class="sig-name descname"><span class="pre">sort_timeseries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.lc.sort_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop through the timeseries associated with this lightcurve (<cite>timeseries</cite>) and sort by time.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.lightcurve.</span></span><span class="sig-name descname"><span class="pre">multilc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ppt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2457000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extralc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoTools.lightcurve.lc</span></code></a></p>
<dl class="simple">
<dt>A flexible lightcurve class built from multiple individual lightcurves</dt><dd><ul class="simple">
<li><p>i.e. a combination of TESS sectors, or an ensemble of both CoRoT, K2 and TESS data</p></li>
</ul>
</dd>
</dl>
<p>Example:
mylc=lc(203311200,’k2’)
mylc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_K2_campaigns">
<span class="sig-name descname"><span class="pre">get_K2_campaigns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_K2_campaigns" title="Permalink to this definition">¶</a></dt>
<dd><p>See which K2 campaigns observed a given target?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em><em>, </em><em>optional</em>) – EPIC ID. Defaults to None, in which case it is taken from <cite>all_ids</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of campaigns in which the target was observed with K2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_all_lightcurves">
<span class="sig-name descname"><span class="pre">get_all_lightcurves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_pipelines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extralc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_all_lightcurves" title="Permalink to this definition">¶</a></dt>
<dd><p>Download all available space photometry for a target. This uses the info stored in <cite>all_ids</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_pipelines</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to download (i.e. simultaneous) photometry from multiple pipelines? Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_all_survey_ids">
<span class="sig-name descname"><span class="pre">get_all_survey_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['all']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_all_survey_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the source ID and mission, search all photometric missions for both the coplementary mission IDs, and extra catalogue data/observability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>search</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of missions to search. Defaults to [‘all’].</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite the info already stored in <cite>all_ids</cite>. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_corot_campaigns">
<span class="sig-name descname"><span class="pre">get_corot_campaigns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_corot_campaigns" title="Permalink to this definition">¶</a></dt>
<dd><p>AI is creating summary for corot_observability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>search_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Square search “radius” (i.e. half boxlength) in arcseconds. Defaults to 15.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A table with each holding data for a CoRoT field</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_corot_lc">
<span class="sig-name descname"><span class="pre">get_corot_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitslink</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">campaign</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_corot_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get single CoRoT lightcurve from link to fits file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fitslink</strong> (<em>str</em>) – HTTP path to fits file on MAST/exoarchive</p></li>
<li><p><strong>campaign</strong> (<em>str</em>) – CoRoT campaign ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CoRoT lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_everest_k2_lc">
<span class="sig-name descname"><span class="pre">get_everest_k2_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_everest_k2_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get single Everest (Luger et al 2016) K2 lightcurve for selected campaign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>int</em>) – EPIC ID of target</p></li>
<li><p><strong>camp</strong> (<em>str</em>) – K2 Campaign</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Detrended K2 lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_k2_lc">
<span class="sig-name descname"><span class="pre">get_k2_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['all']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_k2_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get K2 lightcurve for a single campaign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>camp</strong> (<em>str</em><em> or </em><em>int</em>) – K2 Campaign</p></li>
<li><p><strong>id</strong> (<em>str</em><em> or </em><em>int</em><em>,</em><em>optional</em>) – EPIC ID of target. Defaults to None, in which case the ID is taken from <cite>all_ids</cite></p></li>
<li><p><strong>search</strong> (<em>list</em><em>, </em><em>optional</em>) – Which pipelines to search. Defaults to [‘all’] which will iterate through ‘everest’,’vand’ and then ‘pdc’ until it finds a lightcurve</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Detrended K2 lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_kepler_lc">
<span class="sig-name descname"><span class="pre">get_kepler_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_short_cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_kepler_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Kepler lightcurve for single quarter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>id</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>get_short_cadence</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_pdc_k2_lc">
<span class="sig-name descname"><span class="pre">get_pdc_k2_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_pdc_k2_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get single PDC K2 lightcurve for selected campaign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>int</em>) – EPIC ID of target</p></li>
<li><p><strong>camp</strong> (<em>str</em>) – K2 Campaign</p></li>
<li><p><strong>v</strong> (<em>int</em><em>, </em><em>optional</em>) – Version of pipeline. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Detrended K2 lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_radec">
<span class="sig-name descname"><span class="pre">get_radec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_radec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get radec from ID by searching the input catalogue</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_tess_lc">
<span class="sig-name descname"><span class="pre">get_tess_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['all']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eleanor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_tess_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Access TESS ligthcurve for given sector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sector</strong> (<em>int</em>) – sector to search</p></li>
<li><p><strong>search</strong> (<em>list</em><em>, </em><em>optional</em>) – list of lightcurve sources to search. Defaults to [‘all’].
This will iterate through ‘spoc_20’, ‘spoc_120’, ‘spoc_1800’/’spoc_600’, ‘qlp_1800’/’qlp_600’ and ‘eleanor_1800’/’eleanor_600’ until a lightcurve is found</p></li>
<li><p><strong>use_fast</strong> (<em>bool</em><em>, </em><em>optional</em>) – Search for 20-second data? Defaults to False.</p></li>
<li><p><strong>use_eleanor</strong> (<em>bool</em><em>, </em><em>optional</em>) – Search eleanor? Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TESS lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_tess_sectors">
<span class="sig-name descname"><span class="pre">get_tess_sectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_tess_sectors" title="Permalink to this definition">¶</a></dt>
<dd><p>See which sectors are observable with TESS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>int</em><em>, </em><em>optional</em>) – TIC ID. Defaults to None, in which case it is taken from <cite>all_ids</cite></p></li>
<li><p><strong>sectors</strong> (<em>str</em><em>,</em><em>list of np.ndarray</em><em>, </em><em>optional</em>) – Either ‘all’ (in which case we search all sectors), or a list/array of sectors to search. Defaults to ‘all’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of sectors observed with TESS for the specfied ID</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.get_vanderburg_k2_lc">
<span class="sig-name descname"><span class="pre">get_vanderburg_k2_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.get_vanderburg_k2_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get single K2SFF (Vanderburg et al 2013) K2 lightcurve for selected campaign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – EPIC ID of target</p></li>
<li><p><strong>camp</strong> (<em>str</em>) – K2 Campaign</p></li>
<li><p><strong>v</strong> (<em>int</em><em>, </em><em>optional</em>) – Version of pipeline. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Detrended K2 lightcurve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MonoTools.lightcurve.lc" title="MonoTools.lightcurve.lc">lightcurve.lc</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.load_pickle">
<span class="sig-name descname"><span class="pre">load_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.load_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.make_cadmask">
<span class="sig-name descname"><span class="pre">make_cadmask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.make_cadmask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.make_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Making mask for timeseries. Requires both a “flux” mask (i.e. bad/anomalous points) and a “cadence” mask (i.e. duplicate cadences due to multiple lightcurve sources)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['flux']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jump_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the lightcurve using Matplotlib.</p>
<p>In the default case, either data that is extremely long (i.e Kepler), or data that has a large gap (i.e. TESS Y1/3) will be split into two rows.
Gaps between quarters, sectors, etc will result in horizontally-split plot frames.
Typically ~30min cadence data is plotted unbinned and shorter-cadence ddata is plotted raw and with 30-minute bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_rows</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of rows for the plot to have. Defaults to None, in which case this is automatically guessed between 1 and 4</p></li>
<li><p><strong>timeseries</strong> (<em>list</em><em>, </em><em>optional</em>) – List of which timeseries to plot (i.e. enables plotting of e.g. background flux or flattened flux. Defaults to [‘flux’]</p></li>
<li><p><strong>jump_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Threshold beyond which we call a gap/jump between observations a major difference. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.read_from_file">
<span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sect</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.read_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>opens and processes all lightcurve files (especially, but not only, fits files).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>various types</em>) – opened file. This could be:
- astropy.fits format from kepler, k2 (everest, k2sc, pdc, vand) or tess</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – string of filename. Can be blank for certain file types.</p></li>
<li><p><strong>sect</strong> (<em>str</em>) – string of sector. Can be left blank (i.e. None), but this may make stitching lightcurves more difficult…</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>src (str): String describing source of lightcurve (e.g. pipeline)
mission (str): Photometric mission/telescope of lightcurve (e.g. k2, tess, kepler, etc)
jd_base (float): JD epoch for time=0
flx_system (str): Type of flux used in lightcurve - either “ppm”, “ppt”, “norm0”, “norm1” or “elec” (see <cite>change_flx_system</cite>)
cut_all_anom_lim (float, optional): Perform cuts on all anomalies when masking. Defaults to 4.0.
default_flx_system (str, optional): Default flux system to use. Defaults to ‘ppt’.
force_raw_flux (bool, optional): Force the lightcurve to swap ‘flux’ for ‘raw_flux’ (i.e. due to bad PDC detrending). Defaults to False.
end_of_orbit (bool, optional): Cut/fix the end-of-orbit flux? Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saving the lightcurve as gzipped pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>savename</strong> (<em>str</em><em>, </em><em>optional</em>) – Savename to save to. Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.save_csv">
<span class="sig-name descname"><span class="pre">save_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.save_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>AI is creating summary for save_csv</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>savename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename to save under Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.lightcurve.multilc.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newlcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priorities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.lightcurve.multilc.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks lightcurves onto the multilc object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newlcs</strong> (<em>list</em>) – A list of lightcurve classes (either multilc or lc) to add together</p></li>
<li><p><strong>priorities</strong> (<em>list</em><em>, </em><em>optional</em>) – Which lightcurve sources take priority in the case that they overlap in timing?
This is required in the case that lightcurves are overlapping… Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="monotools-oldcode-module">
<h2>MonoTools.oldcode module<a class="headerlink" href="#monotools-oldcode-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-MonoTools.search">
<span id="monotools-search-module"></span><h2>MonoTools.search module<a class="headerlink" href="#module-MonoTools.search" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.search.Duo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">Duo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.Duo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#MonoTools.search.detection" title="MonoTools.search.detection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoTools.search.detection</span></code></a></p>
<p>The Duotransit detection class - i.e. a candidate with two non-consecutive transits which builds on the generalized <cite>detection</cite> class</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.search.Mono">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">Mono</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.Mono" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#MonoTools.search.detection" title="MonoTools.search.detection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoTools.search.detection</span></code></a></p>
<p>The Monotransit detection class - i.e. a candidate with a single transit which builds on the generalized <cite>detection</cite> class</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.search.Multi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">Multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.Multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#MonoTools.search.detection" title="MonoTools.search.detection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonoTools.search.detection</span></code></a></p>
<p>The Multi-transit detection class - i.e. a candidate with multiple transits and constrained period which builds on the generalized <cite>detection</cite> class</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.search.detection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rvs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The core detection class which represents candidates</p>
<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.detection.QuickFit">
<span class="sig-name descname"><span class="pre">QuickFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useL2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_tdur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndurs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mono'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux_flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.detection.QuickFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Quick fit of candidate detection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>useL2</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>fit_poly</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to True.</p></li>
<li><p><strong>force_tdur</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>polyorder</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 2.</p></li>
<li><p><strong>ndurs</strong> (<em>float</em><em>, </em><em>optional</em>) – [description]. Defaults to 4.2.</p></li>
<li><p><strong>init_period</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>fluxindex</strong> (<em>str</em><em>, </em><em>optional</em>) – [description]. Defaults to ‘flux_flat’.</p></li>
<li><p><strong>mask</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MonoTools.search.target">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The core target class which represents an individual star</p>
<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.AsteroidCheck">
<span class="sig-name descname"><span class="pre">AsteroidCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monoparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_earthshine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.AsteroidCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.CentroidCheck">
<span class="sig-name descname"><span class="pre">CentroidCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monoparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.CentroidCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.CheckInstrumentalNoise">
<span class="sig-name descname"><span class="pre">CheckInstrumentalNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.CheckInstrumentalNoise" title="Permalink to this definition">¶</a></dt>
<dd><p># Using the processed “number of TCEs per cadence” array, we try to use this as a proxy for Instrumental noise in TESS
# Here we simply use the detected SNR over the instrumental noise SNR as a proxy
INPUTS:
- lc
- monotransit dic
- jd_base (assumed to be that of TESS)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.CheckMonoPairs">
<span class="sig-name descname"><span class="pre">CheckMonoPairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_pls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prox_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.CheckMonoPairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.CheckPeriodConfusedPlanets">
<span class="sig-name descname"><span class="pre">CheckPeriodConfusedPlanets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_dets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_mono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_multi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_multi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.CheckPeriodConfusedPlanets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.CutAnomDiff">
<span class="sig-name descname"><span class="pre">CutAnomDiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.CutAnomDiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.DoEBfit">
<span class="sig-name descname"><span class="pre">DoEBfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.DoEBfit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.EB_modelPriors">
<span class="sig-name descname"><span class="pre">EB_modelPriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.EB_modelPriors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.EBmodel">
<span class="sig-name descname"><span class="pre">EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.EBmodel_lnprob">
<span class="sig-name descname"><span class="pre">EBmodel_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.EBmodel_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.EBmodel_neg_lnprob">
<span class="sig-name descname"><span class="pre">EBmodel_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.EBmodel_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.GapCull">
<span class="sig-name descname"><span class="pre">GapCull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boolean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_jump_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.GapCull" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Gaussian_lnprob">
<span class="sig-name descname"><span class="pre">Gaussian_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Gaussian_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Gaussian_neg_lnprob">
<span class="sig-name descname"><span class="pre">Gaussian_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Gaussian_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.GenModelLc">
<span class="sig-name descname"><span class="pre">GenModelLc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_pls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhostar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.43</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.GenModelLc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.MonoVetting">
<span class="sig-name descname"><span class="pre">MonoVetting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useL2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PL_ror_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.MonoVetting" title="Permalink to this definition">¶</a></dt>
<dd><p>#Here we’re going to initialise the Monotransit fitting by searching for other planets/transits/secondaries and filtering out binaries.
INPUTS:
- ID
- mission
- useL2=False
- PL_ror_thresh=0.2</p>
<p><a href="#id5"><span class="problematic" id="id6">**</span></a>kwargs:
- StarPars=None, a list of radius, rho, teff and logg which are each lists of values/errors
- multi_SNR_thresh=6.25,
- plot=True
- file_loc - a location to store images/files
- overwrite=False
For MonoTransitSearch:
- mono_BIC_thresh=-10
- mono_SNR_thresh
- n_oversamp=75,
- use_binned=True
- use_flat=True
- use_poly=True
- binsize=1/96.0,
- Rs=Rstar[0]
- Ms=rhostar[0]*Rstar[0]**3
- Teff=Teff[0],
- plot=plot
- plot_loc=file_loc+”/”
- poly_order=4</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Poly_lnprob">
<span class="sig-name descname"><span class="pre">Poly_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Poly_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Poly_neg_lnprob">
<span class="sig-name descname"><span class="pre">Poly_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Poly_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.QuickMonoFit">
<span class="sig-name descname"><span class="pre">QuickMonoFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useL2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'loguniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndurs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux_flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.QuickMonoFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs simple planet fit to monotransit dip given the detection data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planet</strong> (<em>str</em>) – Candidate identifying to fit</p></li>
<li><p><strong>useL2</strong> (<em>bool</em><em>, </em><em>optional</em>) – Use diluted second light. Defaults to False.</p></li>
<li><p><strong>fit_poly</strong> (<em>bool</em><em>, </em><em>optional</em>) – Fit a transit dip AND a polynomial trend around transit. Defaults to True.</p></li>
<li><p><strong>tdur_prior</strong> (<em>str</em><em>, </em><em>optional</em>) – Prior function to use on tdur - ‘lognormal’,’loguniform’,’normal’ or ‘uniform’. Defaults to ‘loguniform’.</p></li>
<li><p><strong>polyorder</strong> (<em>int</em><em>, </em><em>optional</em>) – Degree of polynomial fit. Defaults to 2.</p></li>
<li><p><strong>ndurs</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of transit durations to fit each side. Defaults to 3.3</p></li>
<li><p><strong>fluxindex</strong> (<em>str</em><em>, </em><em>optional</em>) – Which array in self.lc to use for the fitting. Defaults to ‘flux_flat’.</p></li>
<li><p><strong>mask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Addidtional flux mask to use. Defaults to None (in which can self.lc.mask is used)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Sinusoid_lnprob">
<span class="sig-name descname"><span class="pre">Sinusoid_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Sinusoid_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Sinusoid_neg_lnprob">
<span class="sig-name descname"><span class="pre">Sinusoid_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Sinusoid_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.Step_neg_lnprob">
<span class="sig-name descname"><span class="pre">Step_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.Step_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.VariabilityCheck">
<span class="sig-name descname"><span class="pre">VariabilityCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeltype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndurs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.VariabilityCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.VetCand">
<span class="sig-name descname"><span class="pre">VetCand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNR_r_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vet_do_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.VetCand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.broken_TLS">
<span class="sig-name descname"><span class="pre">broken_TLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masked_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masked_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masked_yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.broken_TLS" title="Permalink to this definition">¶</a></dt>
<dd><p>Running TLS on non-consecutive timeseries.
This is performed by searching for short-period planets in individual sectors and then stacking the resulting power spectra together using interpolation.
For detections found in the stacked power spectrum, a focused TLS is re-run on a small (1%-wide) period window to hone the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masked_t</strong> (<em>np.ndarray</em>) – Time with known transits and anomalies masked</p></li>
<li><p><strong>masked_y</strong> (<em>np.ndarray</em>) – Flux with known transits and anomalies masked. This must be normalised to median 1.0</p></li>
<li><p><strong>masked_yerr</strong> (<em>np.ndarray</em>) – Flux error with known transits and anomalies masked</p></li>
<li><p><strong>max_period</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum period to search. Defaults to 2/3 of the total observation duration.</p></li>
<li><p><strong>min_period</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum period to search. Defaults to 1.1d.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TransitLeastSquares results dictionary for the detected object
np.ndarray: full combined power spectrum with columns of period and power</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.calc_min_P">
<span class="sig-name descname"><span class="pre">calc_min_P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.calc_min_P" title="Permalink to this definition">¶</a></dt>
<dd><p>For a monotransit, calculate the minimum possible radius given that no other transit was detected for this candidate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcen</strong> (<em>float</em>) – Transit epoch</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – Transit durtion</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Minimum period in days</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.centroid_lnprob">
<span class="sig-name descname"><span class="pre">centroid_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.centroid_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.centroid_neg_lnprob">
<span class="sig-name descname"><span class="pre">centroid_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.centroid_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.check_instrum_noise">
<span class="sig-name descname"><span class="pre">check_instrum_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.check_instrum_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.create_transit_mask">
<span class="sig-name descname"><span class="pre">create_transit_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.create_transit_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.dipmodel_centroid">
<span class="sig-name descname"><span class="pre">dipmodel_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.dipmodel_centroid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.dipmodel_gaussian">
<span class="sig-name descname"><span class="pre">dipmodel_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.dipmodel_gaussian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.dipmodel_sinusoid">
<span class="sig-name descname"><span class="pre">dipmodel_sinusoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.dipmodel_sinusoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.dipmodel_step">
<span class="sig-name descname"><span class="pre">dipmodel_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.dipmodel_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.exoplanet_EB_model">
<span class="sig-name descname"><span class="pre">exoplanet_EB_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ellc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.exoplanet_EB_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.get_interpmodels">
<span class="sig-name descname"><span class="pre">get_interpmodels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">texp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.get_interpmodels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.get_snr_red">
<span class="sig-name descname"><span class="pre">get_snr_red</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.get_snr_red" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating std in typical bin with width of the transit duration, to compute SNR_red</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcen</strong> (<em>float</em>) – Transit epoch</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – Transut duration</p></li>
<li><p><strong>planet</strong> (<em>str</em>) – string for the candidate idenfier</p></li>
<li><p><strong>depth</strong> (<em>float</em>) – Depth (as a ratio) of the</p></li>
<li><p><strong>tcen_2</strong> (<em>float</em><em>, </em><em>optional</em>) – Second transit time centre (for duo transiting planets). Defaults to None.</p></li>
<li><p><strong>period</strong> (<em>float</em><em>, </em><em>optional</em>) – Orbital period. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with ‘N_trans’ (number of transits), ‘cdpp’ (scatter at the transit duration) and ‘snr_r’ (S/N of the transit w.r.t. red noise at the transit duration)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.init_mono">
<span class="sig-name descname"><span class="pre">init_mono</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otherinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.init_mono" title="Permalink to this definition">¶</a></dt>
<dd><p>Initalise Monotransit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcen</strong> (<em>float</em>) – transit epoch [d]</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – transit duration [d]</p></li>
<li><p><strong>depth</strong> (<em>float</em>) – transit depth [ratio]</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the detection - for the <cite>detns</cite> dictionary. Defaults to None, in which case it will take a numerical value</p></li>
<li><p><strong>otherinfo</strong> (<em>dict</em><em> or </em><em>pd.Series</em><em>, </em><em>optional</em>) – Dictionary of extra info related to the monotransit detection. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.init_multi">
<span class="sig-name descname"><span class="pre">init_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otherinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.init_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Initalise multi-transiting candidate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tcen</strong> (<em>float</em>) – transit epoch [d]</p></li>
<li><p><strong>tdur</strong> (<em>float</em>) – transit duration [d]</p></li>
<li><p><strong>depth</strong> (<em>float</em>) – transit depth [ratio]</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the detection - for the <cite>detns</cite> dictionary. Defaults to None, in which case it will take a numerical value</p></li>
<li><p><strong>otherinfo</strong> (<em>dict</em><em> or </em><em>pd.Series</em><em>, </em><em>optional</em>) – Dictionary of extra info related to the monotransit detection. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.init_starpars">
<span class="sig-name descname"><span class="pre">init_starpars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhostar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.init_starpars" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise stellar parameters of target star.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_gaussian">
<span class="sig-name descname"><span class="pre">log_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_gaussian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_EBmodel">
<span class="sig-name descname"><span class="pre">log_likelihood_EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_centroid">
<span class="sig-name descname"><span class="pre">log_likelihood_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_centroid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_gaussian_dip">
<span class="sig-name descname"><span class="pre">log_likelihood_gaussian_dip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_gaussian_dip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_poly">
<span class="sig-name descname"><span class="pre">log_likelihood_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_sinusoid">
<span class="sig-name descname"><span class="pre">log_likelihood_sinusoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_sinusoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.log_likelihood_step">
<span class="sig-name descname"><span class="pre">log_likelihood_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.log_likelihood_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.minimize_EBmodel">
<span class="sig-name descname"><span class="pre">minimize_EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ellc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.minimize_EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.model_asteroid_fp">
<span class="sig-name descname"><span class="pre">model_asteroid_fp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.model_asteroid_fp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.model_centroid_shift">
<span class="sig-name descname"><span class="pre">model_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">llk_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.model_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.model_variability_fp">
<span class="sig-name descname"><span class="pre">model_variability_fp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.model_variability_fp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.plot_mono_search">
<span class="sig-name descname"><span class="pre">plot_mono_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.plot_mono_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the results found by <cite>search_monos</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_flat</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the flattened or raw lightcurve. Defaults to True.</p></li>
<li><p><strong>use_binned</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the binned or raw lightcurve. Defaults to True.</p></li>
<li><p><strong>use_poly</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use the local polynomials fits in plotting. Defaults to False.</p></li>
<li><p><strong>transit_zoom</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of window around transit to plot zoom (in transit durations). Defaults to 2.25.</p></li>
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – File location to save plot. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.plot_multi_search">
<span class="sig-name descname"><span class="pre">plot_multi_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.plot_multi_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the output of search_multi_planets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – Location at which to save. Defaults to a file in <cite>self.dataloc</cite></p></li>
<li><p><strong>plot_extent</strong> (<em>float</em><em>, </em><em>optional</em>) – Extent in time of zoom plots in days. Defaults to 0.8.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.plot_vet">
<span class="sig-name descname"><span class="pre">plot_vet</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.plot_vet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.pri_sec_const">
<span class="sig-name descname"><span class="pre">pri_sec_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_pri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_pri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.pri_sec_const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.remove_detn">
<span class="sig-name descname"><span class="pre">remove_detn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.remove_detn" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove candidate detection given the name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – key from the <cite>detns</cite> dict to remove.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.search_monos">
<span class="sig-name descname"><span class="pre">search_monos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mono_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_BIC_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_oversamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.010416666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_monos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stellar_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.search_monos" title="Permalink to this definition">¶</a></dt>
<dd><p>AI is creating summary for search_monos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mono_SNR_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – threshold in sigma to alert mono candidate. Defaults to 6.5.</p></li>
<li><p><strong>mono_BIC_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – threshold in BIC to alert mono candidate. Defaults to -6.</p></li>
<li><p><strong>n_durs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct durations to iterate lightcurve search. Defaults to 5.</p></li>
<li><p><strong>poly_order</strong> (<em>int</em><em>, </em><em>optional</em>) – polynomial order to use for a “no transit” fit. Defaults to 3.</p></li>
<li><p><strong>n_oversamp</strong> (<em>int</em><em>, </em><em>optional</em>) – oversampling factor in transit durations from which to match to lightcurve. Defaults to 20.</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – size of bins in days. Defaults to 15/1440.0.</p></li>
<li><p><strong>custom_mask</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>transit_zoom</strong> (<em>float</em><em>, </em><em>optional</em>) – size (in transit durations) to cut around transit when minimizing transit model. Defaults to 3.5.</p></li>
<li><p><strong>use_flat</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flattens lightcurve before monotransit search. Defaults to False.</p></li>
<li><p><strong>use_binned</strong> (<em>bool</em><em>, </em><em>optional</em>) – Uses binned (rather than raw) lightcurve. Defaults to True.</p></li>
<li><p><strong>use_poly</strong> (<em>bool</em><em>, </em><em>optional</em>) – co-fits transits with a polynomial (order = poly_order-1) to account for variability. Defaults to True.</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the transit search output. Defaults to False.</p></li>
<li><p><strong>plot_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – Location at which to save plot. Defaults to None.</p></li>
<li><p><strong>n_max_monos</strong> (<em>int</em><em>, </em><em>optional</em>) – Max number of mono candidates to save/alert. Defaults to 8.</p></li>
<li><p><strong>use_stellar_dens</strong> (<em>bool</em><em>, </em><em>optional</em>) – Use stellar density to produce transit templates to search. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.search_multi_planets">
<span class="sig-name descname"><span class="pre">search_multi_planets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bin_flux_flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.010416666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_search_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_FAP_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00125</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_prev_planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.search_multi_planets" title="Permalink to this definition">¶</a></dt>
<dd><p>Use transitleastsquares to search for periodic planets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fluxname</strong> (<em>str</em><em>, </em><em>optional</em>) – Which flux array to use for the detection. Defaults to ‘bin_flux_flat’.</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of data binning in days. Defaults to 15/1440.0 (i.e. 15mins).</p></li>
<li><p><strong>n_search_loops</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of times to run a TLS search (i.e. multiple detections). Defaults to 5.</p></li>
<li><p><strong>multi_FAP_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – False Alarm Probability threshold for multi detection. Defaults to 0.00125.</p></li>
<li><p><strong>multi_SNR_thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Signal to Noise Ratio threshold for multi detection. Defaults to 7.0.</p></li>
<li><p><strong>mask_prev_planets</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to mask those events we found during other searches (e.g. search_mono_planets). Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.vet">
<span class="sig-name descname"><span class="pre">vet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tests</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['all']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centroid_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.vet" title="Permalink to this definition">¶</a></dt>
<dd><p>Vet candidate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planet</strong> (<em>str</em>) – String ID for planet candidate</p></li>
<li><p><strong>tests</strong> (<em>list</em><em>, </em><em>optional</em>) – list of tests to perform. Can be one of:
- ‘multidur’;
- ‘model_variability’; Compares transit model fit to a variable (sinusoid) model fit
- ‘model_step’; Compares transit model fit to a step model fit
- ‘check_centroid’; Checks if the transit flux model is also significant in x/y centroids
- ‘check_instrum’; Compares planet SNR to SNR of all candidates at that timestamp
- ‘all’; performs all above tests</p></li>
<li><p><strong>variable_llk_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to -6.</p></li>
<li><p><strong>centroid_llk_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to -6.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MonoTools.search.target.xoEB">
<span class="sig-name descname"><span class="pre">xoEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search.target.xoEB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="MonoTools.search.theano_pars">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search.</span></span><span class="sig-name descname"><span class="pre">theano_pars</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'base_compiledir':</span> <span class="pre">'/Volumes/LUVOIR/MonoToolsData/.theano_dir_6',</span> <span class="pre">'device':</span> <span class="pre">'cpu',</span> <span class="pre">'floatX':</span> <span class="pre">'float64',</span> <span class="pre">'gcc.cxxflags':</span> <span class="pre">'-fbracket-depth=1024'}</span></em><a class="headerlink" href="#MonoTools.search.theano_pars" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’/usr/local/Cellar/gcc/9.3.0_1/bin/g++-9’</p>
</dd>
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’cxx=/Library/Developer/CommandLineTools/usr/bin/g++’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-MonoTools.search_old">
<span id="monotools-search-old-module"></span><h2>MonoTools.search_old module<a class="headerlink" href="#module-MonoTools.search_old" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.AsteroidCheck">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">AsteroidCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monoparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_earthshine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.AsteroidCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.CentroidCheck">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">CentroidCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monoparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.CentroidCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.CheckInstrumentalNoise">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">CheckInstrumentalNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.CheckInstrumentalNoise" title="Permalink to this definition">¶</a></dt>
<dd><p># Using the processed “number of TCEs per cadence” array, we try to use this as a proxy for Instrumental noise in TESS
# Here we simply use the detected SNR over the instrumental noise SNR as a proxy
INPUTS:
- lc
- monotransit dic
- jd_base (assumed to be that of TESS)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.CheckMonoPairs">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">CheckMonoPairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_pls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prox_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.CheckMonoPairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.CheckPeriodConfusedPlanets">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">CheckPeriodConfusedPlanets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_dets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_mono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_multi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_multi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.CheckPeriodConfusedPlanets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.CutAnomDiff">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">CutAnomDiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.CutAnomDiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.DoEBfit">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">DoEBfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.DoEBfit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.EB_modelPriors">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">EB_modelPriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.EB_modelPriors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.EBmodel">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.EBmodel_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">EBmodel_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.EBmodel_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.EBmodel_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">EBmodel_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.EBmodel_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.GapCull">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">GapCull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boolean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_jump_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.GapCull" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Gaussian_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Gaussian_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Gaussian_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Gaussian_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Gaussian_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Gaussian_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.GenModelLc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">GenModelLc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_pls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhostar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.43</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.GenModelLc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.MonoTransitSearch">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">MonoTransitSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_BIC_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_oversamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.010416666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_monos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stellar_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.MonoTransitSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>lc
ID
mono_SNR_thresh=6.5 - threshold in sigma
mono_BIC_thresh=-10 - threshold in BIC to be used for a significant monotransit
n_durs=5
poly_order=3 - polynomial order to use for a “no transit” fit
n_oversamp=10 - oversampling factor wrt to durations from which to match to lightcurve
binsize=1/96. - size of bins in days
transit_zoom=3.5 - size (in transit durations) to cut around transit when minimizing transit model
use_flat=True - flattens lightcurve before monotransit search
use_binned=True
use_poly=True - fits transits (and sin) with a polynomial (order = poly_order-1) to account for variability
Rs=None
Ms=None
Teff=None
plot=False
plot_loc=None
use_stellar_dens=True - use stellar density to produce transit templates to search.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.MonoVetting">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">MonoVetting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useL2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PL_ror_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.MonoVetting" title="Permalink to this definition">¶</a></dt>
<dd><p>#Here we’re going to initialise the Monotransit fitting by searching for other planets/transits/secondaries and filtering out binaries.
INPUTS:
- ID
- mission
- useL2=False
- PL_ror_thresh=0.2</p>
<dl>
<dt><a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs:</dt><dd><ul class="simple">
<li><p>StarPars=None, a list of radius, rho, teff and logg which are each lists of values/errors</p></li>
<li><p>multi_SNR_thresh=6.25,</p></li>
<li><p>plot=True</p></li>
<li><p>file_loc - a location to store images/files</p></li>
<li><p>overwrite=False</p></li>
</ul>
<p>For MonoTransitSearch:
- mono_BIC_thresh=-10
- mono_SNR_thresh
- n_oversamp=75,
- use_binned=True
- use_flat=True
- use_poly=True
- binsize=1/96.0,
- Rs=Rstar[0]
- Ms=rhostar[0]*Rstar[0]**3
- Teff=Teff[0],
- plot=plot
- plot_loc=file_loc+”/”
- poly_order=4</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.PeriodicPlanetSearch">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">PeriodicPlanetSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.010416666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_search_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhostar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_FAP_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00125</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_prev_planets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.PeriodicPlanetSearch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.PlotMonoSearch">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">PlotMonoSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monosearchparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdurs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.PlotMonoSearch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Poly_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Poly_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Poly_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Poly_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Poly_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Poly_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.QuickMonoFit">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">QuickMonoFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useL2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_tdur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndurs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mono'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxindex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux_flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.QuickMonoFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Quick fit of MonoTransit (or )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lc</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>it0</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>dur</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>Rs</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>Ms</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>Teff</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>useL2</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>fit_poly</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to True.</p></li>
<li><p><strong>force_tdur</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>polyorder</strong> (<em>int</em><em>, </em><em>optional</em>) – [description]. Defaults to 2.</p></li>
<li><p><strong>ndurs</strong> (<em>float</em><em>, </em><em>optional</em>) – [description]. Defaults to 4.2.</p></li>
<li><p><strong>how</strong> (<em>str</em><em>, </em><em>optional</em>) – [description]. Defaults to ‘mono’.</p></li>
<li><p><strong>init_period</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
<li><p><strong>fluxindex</strong> (<em>str</em><em>, </em><em>optional</em>) – [description]. Defaults to ‘flux_flat’.</p></li>
<li><p><strong>mask</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Sinusoid_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Sinusoid_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Sinusoid_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Sinusoid_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Sinusoid_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Sinusoid_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.Step_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">Step_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.Step_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.VariabilityCheck">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">VariabilityCheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeltype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndurs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.VariabilityCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.VetCand">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">VetCand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNR_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNR_r_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_llk_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vet_do_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fit_lcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.VetCand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.calc_min_P">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">calc_min_P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.calc_min_P" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.centroid_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">centroid_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.centroid_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.centroid_neg_lnprob">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">centroid_neg_lnprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.centroid_neg_lnprob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.dipmodel_centroid">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">dipmodel_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.dipmodel_centroid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.dipmodel_gaussian">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">dipmodel_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.dipmodel_gaussian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.dipmodel_sinusoid">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">dipmodel_sinusoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.dipmodel_sinusoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.dipmodel_step">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">dipmodel_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.dipmodel_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.exoplanet_EB_model">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">exoplanet_EB_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ellc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.exoplanet_EB_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.get_interpmodels">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">get_interpmodels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc_flux_unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tess'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">texp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.get_interpmodels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_gaussian">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_gaussian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_EBmodel">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_centroid">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_centroid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_gaussian_dip">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_gaussian_dip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_gaussian_dip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_poly">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_sinusoid">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_sinusoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_sinusoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.log_likelihood_step">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npolys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.log_likelihood_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.minimize_EBmodel">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">minimize_EBmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Teffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ellc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.minimize_EBmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.pri_sec_const">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">pri_sec_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_pri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.pri_sec_const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="MonoTools.search_old.theano_pars">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">theano_pars</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'base_compiledir':</span> <span class="pre">'/Volumes/LUVOIR/MonoToolsData/.theano_dir_3',</span> <span class="pre">'device':</span> <span class="pre">'cpu',</span> <span class="pre">'floatX':</span> <span class="pre">'float64',</span> <span class="pre">'gcc.cxxflags':</span> <span class="pre">'-fbracket-depth=1024'}</span></em><a class="headerlink" href="#MonoTools.search_old.theano_pars" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’/usr/local/Cellar/gcc/9.3.0_1/bin/g++-9’</p>
</dd>
<dt>if MonoData_savepath==”/Users/hosborn/python/MonoToolsData” or MonoData_savepath==”/Volumes/LUVOIR/MonoToolsData”:</dt><dd><p>theano_pars[‘cxx’]=’cxx=/Library/Developer/CommandLineTools/usr/bin/g++’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.search_old.xoEB">
<span class="sig-prename descclassname"><span class="pre">MonoTools.search_old.</span></span><span class="sig-name descname"><span class="pre">xoEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.search_old.xoEB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-MonoTools.starpars">
<span id="monotools-starpars-module"></span><h2>MonoTools.starpars module<a class="headerlink" href="#module-MonoTools.starpars" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.Assemble_and_run_isoclassify">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">Assemble_and_run_isoclassify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">icid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">survey_dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exofop_dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_dat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaLum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaBR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useBV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaSpec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use2mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGriz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaAg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.Assemble_and_run_isoclassify" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.CheckSpecCsv">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">CheckSpecCsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh=&lt;Quantity</span> <span class="pre">20.</span> <span class="pre">arcsec&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.CheckSpecCsv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.GetExoFop">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">GetExoFop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">icid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tess'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.GetExoFop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.GetKICinfo">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">GetKICinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.GetKICinfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.IsoClass">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">IsoClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">icid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaLum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaBR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaSpec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useBV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use2mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGriz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaAg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.IsoClass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.LoadDust">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">LoadDust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'allsky'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.LoadDust" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.LoadModel">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">LoadModel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.LoadModel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.MainSequenceFit">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">MainSequenceFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.MainSequenceFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.QueryCats">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">QueryCats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">APASS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.QueryCats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.QueryGaiaAndSurveys">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">QueryGaiaAndSurveys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONESIZE=&lt;Quantity</span> <span class="pre">15.</span> <span class="pre">arcsec&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefile=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission='tess'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop_gaia=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.QueryGaiaAndSurveys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.QueryNearbyGaia">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">QueryNearbyGaia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONESIZE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.QueryNearbyGaia" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.RenameSeries">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">RenameSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.RenameSeries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.TICdata">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">TICdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">getImageData</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.TICdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Download TESS stellar data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>IDs</strong> (<em>tics -- list of TESS</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas DataFrame of stellar info from TIC.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.compileInfos">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">compileInfos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norminfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tic_dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epicdat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.compileInfos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.dens2">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">dens2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loggerr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loggerr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raderr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raderr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masserr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masserr2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnpost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.dens2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.getStellarDensity">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">getStellarDensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.getStellarDensity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.getStellarInfo">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">getStellarInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_surveys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.getStellarInfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.getStellarInfoFromCsv">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">getStellarInfoFromCsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keptabs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_isochrones</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.getStellarInfoFromCsv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.make_numeric">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">make_numeric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.make_numeric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.mastQuery">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">mastQuery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.mastQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a MAST query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>dictionary</strong><strong>)</strong> (<em>request</em>) – </p></li>
<li><p><strong>head</strong> (<em>Returns</em>) – </p></li>
<li><p><strong>headers</strong> (<em>content where head is the response HTTP</em>) – </p></li>
<li><p><strong>data</strong> (<em>and content is the returned</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.starpars.starpars">
<span class="sig-prename descclassname"><span class="pre">MonoTools.starpars.</span></span><span class="sig-name descname"><span class="pre">starpars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">icid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaLum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaBR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaSpec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useBV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use2mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGriz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useGaiaAg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_surveys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.starpars.starpars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-MonoTools.tools">
<span id="monotools-tools-module"></span><h2>MonoTools.tools module<a class="headerlink" href="#module-MonoTools.tools" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.CutAnomDiff">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">CutAnomDiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.CutAnomDiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.CutHighRegions">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">CutHighRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.CutHighRegions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.GetSavename">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">GetSavename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'load'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcmc.pickle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.GetSavename" title="Permalink to this definition">¶</a></dt>
<dd><p># Get unique savename (defaults to MCMC suffic) with format:
# [savefileloc]/[T/K]IC[11-number ID]_[20YY-MM-DD]_[n]_mcmc.pickle
#
# INPUTS:
# - ID
# - mission - (TESS/K2/Kepler)
# - how : ‘load’ or ‘save’
# - suffix : final part of file string. default is _mcmc.pickle
# - overwrite : if ‘save’, whether to overwrite past save or not.
# - savefileloc : file location of files to save (default: ‘MonoTools/[T/K]ID[11-number ID]/
#
# OUTPUTS:
# - filepath</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.K2_lc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">K2_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.K2_lc" title="Permalink to this definition">¶</a></dt>
<dd><p># Opens K2 lc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.LoadLc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">LoadLc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lcid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tess'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.LoadLc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.LoadPickle">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">LoadPickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loadname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.LoadPickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.PlotCorner">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">PlotCorner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TESS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['b',</span> <span class="pre">'ecc',</span> <span class="pre">'period',</span> <span class="pre">'r_pl',</span> <span class="pre">'u_star',</span> <span class="pre">'vrel']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracemask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.PlotCorner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.RunFromScratch">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">RunFromScratch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_SNRthresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_planet_SNRthresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PL_ror_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.RunFromScratch" title="Permalink to this definition">¶</a></dt>
<dd><p># Given only an ID, mission, tcen and tdur, this function will
# - get the lightcurve and stellar parameters
# - check if the candidate is a false positive
# - Search for other transits and/or planets in the lightcurve
# - Run the required Namaste model for all high-SNR planet candidates</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.SavePickle">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">SavePickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.SavePickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.TESS_lc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">TESS_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_qlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eleanor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.TESS_lc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.ToLatexTable">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">ToLatexTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TESS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'columns'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefileloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracemask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.ToLatexTable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.bin_lc_segment">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">bin_lc_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc_segment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_digi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.bin_lc_segment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.create_transit_mask">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">create_transit_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tcens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdurs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.create_transit_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.cutLc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">cutLc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lctimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_bool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.cutLc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.dopolyfit">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">dopolyfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">win</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepcent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ni</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigclip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.dopolyfit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.find_time_regions">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">find_time_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.find_time_regions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.formwindow">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">formwindow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gapthresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.formwindow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.getCorotLC">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">getCorotLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.getCorotLC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.getK2lc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">getK2lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.getK2lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets (or tries to get) all LCs from K2 sources. Order is Everest &gt; Vanderburg &gt; PDC.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.getKeplerLC">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">getKeplerLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'long'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.getKeplerLC" title="Permalink to this definition">¶</a></dt>
<dd><p>This module uses the KIC of a planet candidate to download lightcurves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kic</strong> – EPIC (K2) or KIC (Kepler) id number</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>lightcurve</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.getLDs">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">getLDs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.43812</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FeH</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TESS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.getLDs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.kepler_spline">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">kepler_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bk_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polydegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.kepler_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a best-fit spline curve for a light curve segment.
The spline is fit using an iterative process to remove outliers that may cause
the spline to be “pulled” by discrepent points. In each iteration the spline
is fit, and if there are any points where the absolute deviation from the
median residual is at least 3*sigma (where sigma is a robust estimate of the
standard deviation of the residuals), those points are removed and the spline
is re-fit.
:param time: Numpy array; the time values of the light curve.
:param flux: Numpy array; the flux (brightness) values of the light curve.
:param flux_mask: Numpy array where False values refer to anomalies. Defaults to None
:type flux_mask: np.ndarray of booleans, optional
:param transit_mask: Numpy array where False values refer to in-transit points
:type transit_mask: np.ndarray of booleans, optional
:param bk_space: Spline break point spacing in time units.
:param maxiter: Maximum number of attempts to fit the spline after removing badly</p>
<blockquote>
<div><p>fit points.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outlier_cut</strong> – The maximum number of standard deviations from the median
spline residual before a point is considered an outlier.</p></li>
<li><p><strong>polydegree</strong> – Polynomial degre. Defaults to 3</p></li>
<li><p><strong>reflect</strong> – Whether to perform spline fit using reflection of final time…</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The values of the fitted spline corresponding to the input time</dt><dd><p>values.</p>
</dd>
</dl>
<p>mask: Boolean mask indicating the points used to fit the final spline.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>spline</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>InsufficientPointsError</strong> – If there were insufficient points (after removing
    outliers) for spline fitting.</p></li>
<li><p><strong>SplineError</strong> – If the spline could not be fit, for example if the breakpoint
    spacing is too small.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.lcBin">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">lcBin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.020833333333333332</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_masked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extramask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modify_lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.lcBin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.lcFlatten">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">lcFlatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polydegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaclip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gapthreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reflect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transit_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.lcFlatten" title="Permalink to this definition">¶</a></dt>
<dd><p>#Flattens any lightcurve while maintaining in-transit depth.</p>
<p>Args:
lc.           # dictionary with time,flux,flux_err, flux_unit (1.0 or 0.001 [ppt]) and mask
winsize = 2   #days, size of polynomial fitting region
stepsize = 0.2  #days, size of region within polynomial region to detrend
polydegree = 3  #degree of polynomial to fit to local curve
niter = 20      #number of iterations to fit polynomial, clipping points significantly deviant from curve each time.
sigmaclip = 3.   #significance at which points are clipped (as niter)
gapthreshold = 1.0  #days, threshold at which a gap in the time series is detected and the local curve is adjusted to not run over it
use_binned = False. #Using the binned values in the lc dict
use_mask = True.    #Use the lightcurve mask to remove pre-determined anomalous values from fitting
reflect = True      #Whether to use end-of-lightcurve reflection to remove poor end-of-lc detrending
transit_mask = None #bolean array masking known transits so that their depressed flux wont influence the polynomial fitting</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.lcStack">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">lcStack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lcs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.lcStack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.lcStackDicts">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">lcStackDicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lcdicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.lcStackDicts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.maskLc">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">maskLc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhead</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_all_anom_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_of_orbit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_binned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_islands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.maskLc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.observed">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">observed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.observed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.openEverest">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">openEverest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">durs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.openEverest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.openFits">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">openFits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_all_anom_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_raw_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_of_orbit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.openFits" title="Permalink to this definition">¶</a></dt>
<dd><p>opens and processes all lightcurve files (especially, but not only, fits files).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>fname</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>mission</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p></li>
<li><p><strong>cut_all_anom_lim</strong> (<em>float</em><em>, </em><em>optional</em>) – [description]. Defaults to 4.0.</p></li>
<li><p><strong>use_ppt</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to True.</p></li>
<li><p><strong>force_raw_flux</strong> (<em>bool</em><em>, </em><em>optional</em>) – [description]. Defaults to False.</p></li>
<li><p><strong>end_of_orbit</strong> (<em>bool</em><em>, </em><em>optional</em>) – Cut/fix the end-of-orbit flux? Defaults to False.</p></li>
<li><p><strong>mask</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.openLightCurve">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">openLightCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2457000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.openLightCurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.openPDC">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">openPDC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.openPDC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.openVand">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">openVand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ppt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.openVand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.partition_list">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">partition_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.partition_list" title="Permalink to this definition">¶</a></dt>
<dd><p>AI is creating summary for partition_list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>list</em>) – Ordered list of lengths that we wish to evenly split into k pieces</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of parts along which to split a</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordered index of which of <cite>k</cite> bins the value in <cite>a</cite> belongs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.robust_mean">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">robust_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.robust_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a robust mean estimate in the presence of outliers.
:param y: 1D numpy array. Assumed to be normally distributed with outliers.
:param cut: Points more than this number of standard deviations from the median are</p>
<blockquote>
<div><p>ignored.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>A robust estimate of the mean of y.
mean_stddev: The standard deviation of the mean.
mask: Boolean array with the same length as y. Values corresponding to</p>
<blockquote>
<div><p>outliers in y are False. All other values are True.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>mean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.update_lc_locs">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">update_lc_locs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">most_recent_sect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.update_lc_locs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.vals_to_latex">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">vals_to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.vals_to_latex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MonoTools.tools.weighted_avg_and_std">
<span class="sig-prename descclassname"><span class="pre">MonoTools.tools.</span></span><span class="sig-name descname"><span class="pre">weighted_avg_and_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masknans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MonoTools.tools.weighted_avg_and_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted average and standard deviation.</p>
<p>values, weights – Numpy ndarrays with the same shape.</p>
</dd></dl>

</section>
<section id="module-MonoTools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-MonoTools" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MonoTools</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">MonoTools</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MonoTools package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">MonoTools</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">MonoTools</a></li>
      <li>Next: <a href="using_lightcurve.html" title="next chapter">&lt;no title&gt;</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Hugh P. Osborn.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/MonoTools.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>